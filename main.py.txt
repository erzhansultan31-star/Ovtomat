import telebot
from telebot import types
import traceback

# üîπ –ë–æ—Ç—Ç—ã“£ —Ç–æ–∫–µ–Ω—ñ
BOT_TOKEN = "–ú“∞–ù–î–ê ”®–ó –¢–û–ö–ï–ù–Ü“¢–î–Ü –ñ–ê–ó"  
bot = telebot.TeleBot(BOT_TOKEN, parse_mode="HTML")

# üîπ –ê—Ä–Ω–∞–ª–∞—Ä –º–µ–Ω ”ô–∫—ñ–º
SOURCE_CHANNEL = "@GOAL24Main"          # “õ–∞–π –∫–∞–Ω–∞–ª–¥–∞–Ω –∞–ª–∞–¥—ã
TARGET_CHANNEL = "-1002948354799"       # “õ–∞–π –∫–∞–Ω–∞–ª“ì–∞ –∂—ñ–±–µ—Ä–µ–¥—ñ
ADMIN_ID = 1815036801                   # —Å–∞“ì–∞–Ω —Ö–∞–±–∞—Ä –∂—ñ–±–µ—Ä–µ–¥—ñ (“õ–∞—Ç–µ —à—ã“õ—Å–∞)

# ------------------------------------------------------------
# ‚öôÔ∏è –†–µ–∫–ª–∞–º–∞ —Å“Ø–∑–≥—ñ—Å—ñ
def contains_ad(text: str):
    if not text:
        return False
    ads_words = [
        "—Ä–µ–∫–ª–∞–º–∞", "sponsor", "sponsored", "–ø–∞—Ä—Ç–Ω–µ—Ä", "–ø–∞—Ä—Ç–Ω—ë—Ä", 
        "–±–æ—Ç", "channel", "promo", "–∂–∞—Ä–Ω–∞–º–∞"
    ]
    return any(word.lower() in text.lower() for word in ads_words)

# ------------------------------------------------------------
# üì© –ñ–∞“£–∞ –ø–æ—Å—Ç—Ç–∞—Ä
@bot.channel_post_handler(func=lambda msg: True)
def repost_message(msg):
    try:
        # –ï–≥–µ—Ä –ø–æ—Å—Ç GOAL24Main –∫–∞–Ω–∞–ª—ã–Ω–∞–Ω –±–æ–ª—Å–∞
        if msg.chat.username == SOURCE_CHANNEL.replace("@", ""):
            
            # –ï–≥–µ—Ä –∂–∞—Ä–Ω–∞–º–∞ –±–æ–ª—Å–∞ ‚Äì ”©—Ç–∫—ñ–∑—ñ–ø –∂—ñ–±–µ—Ä–µ–º—ñ–∑
            if msg.text and contains_ad(msg.text):
                print("üö´ –†–µ–∫–ª–∞–º–∞ —Ç–∞–±—ã–ª–¥—ã ‚Äî ”©—Ç–∫—ñ–∑—ñ–ª—ñ–ø –∫–µ—Ç—Ç—ñ.")
                return
            
            # –•–∞–±–∞—Ä–ª–∞–º–∞–Ω—ã –∫”©—à—ñ—Ä—É (forward –µ–º–µ—Å)
            if msg.text:
                bot.send_message(TARGET_CHANNEL, msg.text)
            elif msg.caption and msg.photo:
                bot.send_photo(TARGET_CHANNEL, msg.photo[-1].file_id, caption=msg.caption)
            elif msg.video:
                bot.send_video(TARGET_CHANNEL, msg.video.file_id, caption=msg.caption or "")
            elif msg.animation:
                bot.send_animation(TARGET_CHANNEL, msg.animation.file_id, caption=msg.caption or "")
            else:
                print("‚ö†Ô∏è –•–∞–±–∞—Ä–ª–∞–º–∞ —Ç“Ø—Ä—ñ —Ç–∞–Ω—ã–ª–º–∞–¥—ã.")
            
            print("‚úÖ –ü–æ—Å—Ç —Å”ô—Ç—Ç—ñ –∫”©—à—ñ—Ä—ñ–ª–¥—ñ!")

    except Exception as e:
        error_text = f"‚ùå “ö–∞—Ç–µ —à—ã“õ—Ç—ã:\n{traceback.format_exc()}"
        bot.send_message(ADMIN_ID, error_text)

# ------------------------------------------------------------
print("üöÄ –ë–æ—Ç —ñ—Å–∫–µ “õ–æ—Å—ã–ª–¥—ã. GOAL24Main –∫–∞–Ω–∞–ª—ã–Ω –±–∞“õ—ã–ª–∞—É–¥–∞...")
bot.polling(non_stop=True)